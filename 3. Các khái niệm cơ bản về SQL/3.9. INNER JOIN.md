### I. Định nghĩa và Cơ chế Lọc

`INNER JOIN` hoạt động như một bộ lọc kép, loại bỏ bất kỳ hàng nào không đáp ứng điều kiện khớp (`ON clause`) ở một trong hai bảng được tham chiếu.

1.  **Nguyên tắc Cơ bản:** `INNER JOIN` chỉ trả về các bản ghi có các giá trị khớp trong cả hai bảng.
2.  **Kết quả Đầu ra:** Nếu một hàng trong Bảng A không có bản ghi khớp trong Bảng B, hàng đó sẽ bị loại bỏ khỏi kết quả. Tương tự, nếu một hàng trong Bảng B không có bản ghi khớp trong Bảng A, hàng đó cũng sẽ bị loại bỏ. Kết quả là một tập hợp dữ liệu chỉ chứa các cặp khớp.
3.  **Cấu trúc Truy vấn:** Cú pháp cho `INNER JOIN` tuân theo cấu trúc JOIN chung, trong đó mệnh đề `ON` xác định các trường khóa chính/khóa ngoại được sử dụng để khớp các hàng:
    ```sql
    FROM [left table]
    INNER JOIN [right table]
    ON [left table].[field] = [right table].[field]
    ```

### II. So sánh với LEFT và RIGHT JOINs

Sự khác biệt của `INNER JOIN` được làm nổi bật khi so sánh với `LEFT JOIN` và `RIGHT JOIN` bằng cách sử dụng các bản ghi không khớp trong CSDL mẫu.

*   **Loại bỏ các bản ghi không khớp:** Trong minh họa kết nối bảng `product` và `product_category`, nếu thực hiện `INNER JOIN`:
    *   Hàng trong bảng `product` có `product_category_id` là `NULL` sẽ bị loại bỏ (hàng này được giữ lại trong `LEFT JOIN`).
    *   Hàng trong bảng `product_category` có `product_category_id` là 6 (không có sản phẩm nào thuộc loại này) sẽ bị loại bỏ (hàng này được giữ lại trong `RIGHT JOIN`).
    *   Kết quả cuối cùng của `INNER JOIN` là một tập hợp dữ liệu không có bất kỳ hàng nào chứa giá trị `NULL` ở phía bên kia của kết nối.

### III. Ứng dụng trong Khoa học Dữ liệu và Phân tích

`INNER JOIN` được sử dụng khi nhà phân tích hoặc nhà khoa học dữ liệu **chỉ quan tâm đến các bản ghi có liên kết hợp lệ** và muốn loại trừ dữ liệu không có đối tác.

1.  **Tính toán Doanh số/Tồn kho:** Trong ví dụ phân tích về doanh số sản phẩm tươi theo tuần, tác giả đã sử dụng `INNER JOIN` giữa bảng mua hàng (`customer_purchases`) và bảng sản phẩm (`product`) vì họ **không quan tâm đến các sản phẩm không có giao dịch mua hàng** trong tính toán doanh số này.
2.  **Tính toán Tổng hợp (Aggregation):** `INNER JOIN` thường được sử dụng khi chuẩn bị dữ liệu cho các báo cáo tổng hợp. Ví dụ, để tìm giá thấp nhất và cao nhất (`MIN` và `MAX`) cho mỗi danh mục sản phẩm, `INNER JOIN` được sử dụng để kết nối ba bảng: `vendor_inventory`, `product`, và `product_category`.
3.  **Phát triển Đặc trưng (Feature Engineering):** Trong ví dụ phức tạp về tính toán các đặc trưng (features) cho mô hình phân loại, các hàm tổng hợp như `SUM` và `CASE` được sử dụng cùng với `INNER JOIN` giữa các bảng `customer_purchases` và `product`.
4.  **Các trường hợp đặc biệt trong CSDL mẫu:** Khi kết nối bảng `customer` và `customer_purchases` trong CSDL Farmer's Market, `INNER JOIN` trả về kết quả tương tự như `RIGHT JOIN`. Điều này xảy ra vì trong dữ liệu mẫu, mọi giao dịch mua hàng (bảng bên phải) đều có ID khách hàng khớp.

### IV. Bẫy Phổ biến (Common Pitfall)

Trong bối cảnh `JOINs`, một lỗi logic phổ biến có thể khiến `LEFT JOIN` hoạt động giống như `INNER JOIN`.

*   Nếu bạn thực hiện `LEFT JOIN` và sau đó áp dụng bộ lọc trong mệnh đề `WHERE` trên một trường của bảng "bên phải" (right table) mà **không cho phép giá trị `NULL`** cho trường đó, bạn sẽ vô tình loại bỏ tất cả các hàng không khớp (vốn có giá trị `NULL` ở bảng bên phải). Hành động này biến truy vấn thành `INNER JOIN`.
*   Để tránh điều này khi sử dụng `LEFT JOIN`, nếu cần lọc trên bảng bên phải, cần phải thêm điều kiện `OR [field] IS NULL` vào mệnh đề `WHERE` để giữ lại các hàng không khớp từ bảng bên trái.