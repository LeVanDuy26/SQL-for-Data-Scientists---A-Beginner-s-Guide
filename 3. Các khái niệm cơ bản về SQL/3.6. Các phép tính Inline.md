### I. Giới thiệu về Phép tính Nội tuyến Đơn giản (Simple Inline Calculations)

Phép tính nội tuyến là các thao tác được thực hiện **trên dữ liệu trong một hàng** (row level) trước khi dữ liệu đó được tổng hợp (aggregated).

1.  **Mục đích:** Các phép tính này cho phép người dùng thực hiện các phép toán số học hoặc thao tác chuỗi đơn giản trên các cột trong mỗi hàng.
2.  **Ví dụ về Phép toán Số học:**
    *   Sử dụng dấu **nhân (\*)** để nhân giá trị trong hai cột với nhau. Ví dụ, trong bảng `customer_purchases`, có thể nhân cột `quantity` (số lượng) với cột `cost_to_customer_per_qty` (giá cho mỗi đơn vị) để tính ra **giá tổng (price)** của một mặt hàng cụ thể trong giao dịch đó.
    *   Các phép tính này có thể được bao quanh bởi các hàm tổng hợp như `SUM()` để tính tổng của các phép tính nội tuyến này trên nhiều hàng.

3.  **Bí danh Cột (Column Alias):**
    *   Sau khi thực hiện phép tính nội tuyến, kết quả là một cột mới. Để đặt tên có ý nghĩa cho cột tính toán này, người dùng nên sử dụng **bí danh (alias)** bằng cách thêm từ khóa **`AS`** sau phép tính, và sau đó chỉ định tên mới.
    *   Nếu bí danh cột chứa khoảng trắng, nó cần được đặt trong dấu ngoặc đơn.
    *   Mặc dù từ khóa `AS` là tùy chọn trong cú pháp MySQL, tác giả khuyến nghị nên sử dụng nó để đảm bảo rõ ràng và nhất quán.

### II. Các Ví dụ về Hàm SQL Nội tuyến

Bên cạnh các phép toán số học cơ bản, các phép tính nội tuyến thường sử dụng **Hàm SQL (SQL Functions)**.

#### 1. Cấu trúc Hàm SQL
Một hàm SQL là một đoạn mã nhận các đầu vào (gọi là **tham số - parameters**), thực hiện một thao tác nào đó trên các đầu vào đó, và trả về một giá trị.
Cú pháp gọi hàm là: `FUNCTION_NAME([parameter 1], [parameter 2], ... [parameter n])`.

#### 2. Hàm Làm tròn (Rounding)
*   **Hàm `ROUND()`:** Hàm này được sử dụng để làm tròn một số.
*   **Tham số:** Tham số đầu tiên là giá trị cần làm tròn (có thể là tên cột hoặc kết quả của một phép tính), tham số thứ hai là số chữ số thập phân mong muốn (ví dụ: `2` cho làm tròn đến cent gần nhất).
*   **Ví dụ:** `ROUND(quantity * cost_to_customer_per_qty, 2) AS price` sẽ làm tròn kết quả phép tính giá đến hai chữ số thập phân.
*   **Ghi chú:** Hàm `ROUND()` cũng chấp nhận số âm cho tham số thứ hai để làm tròn các chữ số bên trái dấu thập phân.

#### 3. Hàm Nối Chuỗi (Concatenating Strings)
*   **Hàm `CONCAT()`:** Hàm này được dùng để **hợp nhất (merge) các giá trị chuỗi** lại với nhau.
*   **Tham số:** Các chuỗi hoặc tên cột cần nối được liệt kê làm tham số, phân tách bằng dấu phẩy. Khoảng trắng hoặc ký tự phân cách cần được bao quanh bởi dấu ngoặc kép hoặc đơn.
*   **Ví dụ:** `CONCAT(customer_first_name, " ", customer_last_name) AS customer_name` sẽ nối Tên và Họ của khách hàng, với một khoảng trắng ở giữa.

#### 4. Lồng Hàm (Nesting Functions)
Có thể lồng các hàm bên trong các hàm khác, và các hàm sẽ được thực thi **từ "trong ra ngoài"**.
*   **Ví dụ:** `UPPER(CONCAT(customer_last_name, ", ", customer_first_name))` sẽ thực hiện nối chuỗi trước, sau đó hàm `UPPER()` sẽ được thực thi để chuyển đổi toàn bộ chuỗi kết quả thành chữ in hoa.

### III. Bối cảnh Rộng hơn trong Các Khái niệm Cơ bản

Các phép tính nội tuyến được sử dụng trong các chương cơ bản (Chương 2-5) để:

*   **Tạo Cột Dẫn xuất:** Chuẩn bị cho việc sử dụng các **cột dẫn xuất** phức tạp hơn trong Chương 4 (`CASE Statements`), nơi logic có điều kiện được sử dụng để tạo các trường mới.
*   **Xác định Đầu vào cho Tổng hợp:** Các phép tính nội tuyến được thực hiện **trước** khi các mệnh đề tổng hợp (`GROUP BY`, `HAVING`) được xử lý. Điều này có nghĩa là kết quả của phép tính nội tuyến (ví dụ: `price` tính toán) có thể được sử dụng làm đầu vào cho các hàm tổng hợp.
*   **Tăng Tính Đọc Hiểu:** Việc sử dụng bí danh cho các cột tính toán giúp cải thiện đáng kể khả năng đọc và hiểu truy vấn.