### I. Khái niệm và Mục đích của Binary Flags

Binary Flags (Cờ nhị phân) là một loại trường dữ liệu (field) **chỉ chứa hai giá trị: 1 hoặc 0**.

*   **Ý nghĩa:** Giá trị `1` thường biểu thị cho ý nghĩa "Có" (Yes), "Tồn tại" (Exists), hoặc điều kiện là "Đúng" (True). Ngược lại, giá trị `0` biểu thị cho ý nghĩa "Không" (No), "Không tồn tại" (Doesn't exist), hoặc điều kiện là "Sai" (False).
*   **Tầm quan trọng trong Khoa học Dữ liệu:** Các cờ nhị phân là một loại tính năng (feature) thường được sử dụng trong các tập dữ liệu dành cho **học máy (machine learning datasets)**, đặc biệt là cho các mô hình phân loại nhị phân (binary classification). Nhiều thuật toán học máy hoạt động hiệu quả nhất với dữ liệu số, và việc chuyển đổi các thuộc tính phân loại (categorical attributes) thành định dạng số (như 0/1) là một bước cần thiết trong **Kỹ thuật Tính năng (Feature Engineering)**.

### II. Cách Tạo Binary Flags bằng CASE Statements

CASE Statements là công cụ lý tưởng để tạo ra các cờ nhị phân vì chúng cho phép người dùng định nghĩa rõ ràng các điều kiện logic để chuyển đổi từ giá trị ban đầu sang 1 hoặc 0.

#### 1. Cấu trúc Cú pháp
Việc tạo cờ nhị phân tuân theo cú pháp `CASE WHEN...THEN...ELSE END` cơ bản, trong đó phần `THEN` và `ELSE` chỉ trả về giá trị `1` hoặc `0`:

```sql
CASE
    WHEN [câu lệnh điều kiện]
        THEN 1
    ELSE 0
END AS [tên_cột_flag]
```

#### 2. Ví dụ Chi tiết (Sử dụng dữ liệu Thị trường Nông sản)

Nguồn tài liệu cung cấp ví dụ cụ thể về việc chuyển đổi thông tin về ngày trong tuần thành một cờ nhị phân:

*   **Tình huống:** Các thị trường nông sản trong cơ sở dữ liệu thường diễn ra vào tối Thứ Tư (ngày trong tuần) hoặc sáng Thứ Bảy (cuối tuần). Thuật toán học máy có thể không hiểu được ý nghĩa của các chuỗi ký tự "Wednesday" và "Saturday".
*   **Mục tiêu:** Tạo một cờ nhị phân có tên `weekend_flag` (cờ cuối tuần), gán giá trị **1** nếu thị trường diễn ra vào Thứ Bảy hoặc Chủ Nhật, và **0** nếu không phải.

**Truy vấn SQL:**

```sql
SELECT
    market_date,
    CASE
        WHEN market_day = 'Saturday' OR market_day = 'Sunday'
            THEN 1
        ELSE 0
    END AS weekend_flag
FROM farmers_market.market_date_info
LIMIT 5
```

Trong ví dụ này, cờ `weekend_flag` sẽ nhận giá trị `1` nếu điều kiện `market_day = 'Saturday' OR market_day = 'Sunday'` là **TRUE**, và nhận giá trị `0` trong trường hợp ngược lại.

#### 3. Cân nhắc về Phạm vi Điều kiện

Trong ví dụ trên, tác giả đã cố tình bao gồm cả `Sunday` (Chủ Nhật) vào điều kiện, mặc dù thị trường hiện tại không mở cửa vào Chủ Nhật. Điều này nhằm đảm bảo rằng:

*   **Tính rõ ràng:** Tên trường `weekend_flag` thực sự phản ánh ý nghĩa "cuối tuần".
*   **Khả năng mở rộng:** Nếu lịch trình thị trường thay đổi hoặc mở rộng sang Chủ Nhật trong tương lai, CASE statement này vẫn **chính xác** gắn cờ đó là thị trường cuối tuần cho mục đích phân tích.

### III. Các Ứng dụng Nâng cao khác của Binary Flags

Việc tạo cờ nhị phân không chỉ giới hạn ở việc chuyển đổi các biến phân loại thành số mà còn được dùng để đánh dấu các sự kiện hoặc điều kiện quan trọng:

1.  **Đánh dấu Điều kiện Giá trị:**
    *   Tạo cờ nhị phân dựa trên giá trị số, ví dụ: cờ `price_over_50` (giá trên $50).
    *   Sử dụng cú pháp: `CASE WHEN quantity * cost_to_customer_per_qty > 50 THEN 1 ELSE 0 END AS price_over_50`. Cờ này cho phép nhà khoa học dữ liệu dễ dàng phân tích mối quan hệ giữa các giao dịch lớn và biến mục tiêu (target variable).

2.  **Mã hóa Một-Nóng (One-Hot Encoding):**
    *   Khi các biến phân loại không có thứ tự (ví dụ: loại nhà cung cấp), cờ nhị phân được sử dụng để tạo ra một cột mới cho mỗi danh mục. Đây là quá trình Mã hóa Một-Nóng (One-Hot Encoding).
    *   Mỗi CASE Statement sẽ kiểm tra xem hàng đó có thuộc về danh mục cụ thể đó không (ví dụ: `vendor_type = 'Arts & Jewelry'`), trả về **1** nếu đúng, và **0** nếu sai.

3.  **Tạo Biến Mục tiêu (Target Variable):**
    *   Trong mô hình phân loại nhị phân (Binary Classification), cờ nhị phân được sử dụng để tạo ra biến mục tiêu (target variable) cần dự đoán.
    *   Ví dụ: Cột `purchased_again_within_30_days` (có mua lại trong vòng 30 ngày không?) sẽ nhận giá trị **1** hoặc **0**, dựa trên việc kiểm tra điều kiện ngày tháng phức tạp (thường sử dụng hàm `DATEDIFF` và truy vấn con).

Tóm lại, **tạo Binary Flags (0/1)** là ứng dụng thiết yếu của CASE Statements, giúp các nhà khoa học dữ liệu **chuyển đổi dữ liệu thô và logic điều kiện thành các tính năng số hóa** phù hợp cho việc phân tích sâu hơn và xây dựng mô hình học máy.