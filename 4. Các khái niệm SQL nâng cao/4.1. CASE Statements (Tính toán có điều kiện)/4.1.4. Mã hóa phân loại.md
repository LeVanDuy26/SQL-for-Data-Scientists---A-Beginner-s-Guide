### I. Khái niệm và Mục đích của Mã hóa Phân loại

Trong quá trình **Kỹ thuật Tính năng (Feature Engineering)** để phát triển tập dữ liệu cho học máy, các thuật toán toán học thường không thể xử lý trực tiếp các biến phân loại dạng chuỗi (categorical string variables). **Mã hóa phân loại** là quá trình chuyển đổi các biến chuỗi này thành các biến số để các thuật toán có thể sử dụng chúng làm đầu vào.

CASE Statements là cơ chế trong SQL cho phép thực hiện logic điều kiện để tạo ra các cột mới (derived columns) hoặc thay đổi giá trị trong một cột, bao gồm cả việc chuyển đổi các thuộc tính thành định dạng số hóa mà các thuật toán học máy có thể sử dụng.

Có hai phương pháp chính được đề cập:

#### 1. Mã hóa theo Thứ hạng (Rank Order Encoding)

Nếu các danh mục có thứ tự rõ ràng hoặc đại diện cho một thứ hạng có thể sắp xếp, chúng có thể được chuyển đổi thành các giá trị số tương ứng với thứ tự đó.

*   **Ví dụ:** Trong cơ sở dữ liệu Farmer’s Market, các mức giá thuê gian hàng được dán nhãn bằng các chữ cái "A," "B," và "C," theo thứ tự tăng dần của giá. CASE Statements có thể chuyển đổi các mức này thành giá trị số 1, 2, và 3 (hoặc giá thuê thực tế).

#### 2. Mã hóa Một-Nóng (One-Hot Encoding)

Kỹ thuật này được sử dụng khi các danh mục **không có bất kỳ thứ tự hay thứ hạng cố định nào** (ví dụ: các loại nhà cung cấp). Việc gán thứ tự ngẫu nhiên (như 1, 2, 3) cho các danh mục không có thứ hạng sẽ vô tình chỉ ra một thứ tự sắp xếp (sort order) cho thuật toán, điều này có thể gây hiểu lầm.

### II. Cú pháp và Cách thức hoạt động của Mã hóa Một-Nóng (One-Hot Encoding)

Mã hóa Một-Nóng giải quyết vấn đề thứ hạng bằng cách tạo ra một cột mới cho mỗi danh mục có thể có của biến gốc.

*   **Mô tả:** Đối với mỗi hàng (record) trong tập dữ liệu, kỹ thuật này gán giá trị **1** cho cột mới đại diện cho danh mục mà hàng đó thuộc về, và gán **0** cho tất cả các cột mới khác.
*   **Tên gọi khác:** Các cột này đôi khi được gọi là "biến giả" (dummy variables).

#### Cú pháp sử dụng CASE Statements

Mã hóa Một-Nóng được thực hiện bằng cách sử dụng **nhiều CASE Statements riêng biệt**, mỗi câu lệnh tạo ra một cột nhị phân (binary flag field) mới kiểm tra một danh mục cụ thể.

**Ví dụ Mã hóa Một-Nóng cho `vendor_type`:**

```sql
SELECT
    vendor_id,
    vendor_name,
    vendor_type,
    CASE WHEN vendor_type = 'Arts & Jewelry'
        THEN 1
        ELSE 0
    END AS vendor_type_arts_jewelry, -- Cột 1
    CASE WHEN vendor_type = 'Eggs & Meats'
        THEN 1
        ELSE 0
    END AS vendor_type_eggs_meats, -- Cột 2
    ... (Thêm các CASE Statements cho các loại nhà cung cấp khác)
FROM farmers_market.vendor
```

Trong ví dụ trên, nếu `vendor_type` của một hàng là 'Arts & Jewelry', cột `vendor_type_arts_jewelry` sẽ là 1, và tất cả các cột `vendor_type_[khác]` đều là 0.

### III. Thận trọng và Giới hạn

Khi sử dụng CASE Statements để mã hóa các biến phân loại, đặc biệt là Mã hóa Một-Nóng, nhà khoa học dữ liệu cần lưu ý:

1.  **Tính đầy đủ:** Nếu một danh mục mới (ví dụ: một loại nhà cung cấp mới) được thêm vào cơ sở dữ liệu sau khi truy vấn được viết, **truy vấn sẽ không tự động tạo ra một cột mới** cho danh mục đó. Người dùng sẽ phải tự thêm một CASE Statement mới để tính đến danh mục mới này.
2.  **Sử dụng Cờ nhị phân (Binary Flags):** Việc tạo Binary Flags (giá trị 1 hoặc 0) bằng CASE Statements là nền tảng cho Mã hóa Một-Nóng. Một cờ nhị phân thường được sử dụng để chỉ ra sự tồn tại hay không tồn tại của một thuộc tính nào đó.

Tóm lại, Mã hóa phân loại, đặc biệt là Mã hóa Một-Nóng sử dụng CASE Statements, là một bước quan trọng trong việc chuyển đổi các dữ liệu văn bản thành các tính năng số (numeric features) cần thiết để xây dựng và huấn luyện các mô hình học máy.