### I. Khái niệm và Mục đích của EXTRACT/DATE_PART

Khi làm việc với kiểu dữ liệu `datetime` (chẳng hạn như dấu thời gian), nhà khoa học dữ liệu thường chỉ cần một phần cụ thể của giá trị đã lưu trữ.

1.  **Mục đích:** Các hàm `EXTRACT()`/`DATE_PART` cho phép người dùng trích xuất các thành phần riêng lẻ (chẳng hạn như năm, tháng, ngày, giờ, phút) từ một trường `datetime` hoàn chỉnh.
2.  **Ứng dụng Phân tích:** Việc trích xuất này rất hữu ích khi cần tạo các tính năng (features) riêng biệt cho mô hình hoặc cho các báo cáo phân tích. Ví dụ, người ta có thể cần tách **tháng và ngày** vào một trường, và **năm** vào một trường khác, để thực hiện so sánh **năm qua năm (year-over-year comparison)**, nhằm trực quan hóa tổng số hàng ngày từ các năm khác nhau theo tháng và ngày.

### II. Cú pháp và Khả năng Tương thích Giữa các Hệ thống

Cú pháp của hàm trích xuất khác nhau tùy thuộc vào hệ thống cơ sở dữ liệu (database system) đang được sử dụng.

| Hệ thống Cơ sở Dữ liệu | Tên Hàm | Cú pháp |
| :--- | :--- | :--- |
| **MySQL** | `EXTRACT()` | `EXTRACT([date part] FROM [datetime field])` |
| **Redshift** | `DATE_PART` | Cùng khái niệm, nhưng cú pháp có thể khác. |
| **Oracle & SQL Server** | `DATEPART` | Cùng khái niệm, nhưng cú pháp có thể khác. |

Vì cơ sở dữ liệu ví dụ trong sách là MySQL, các ví dụ được cung cấp sử dụng hàm `EXTRACT()`.

### III. Các Thành phần Ngày/Giờ Có thể Trích xuất

Hàm `EXTRACT()` cho phép trích xuất nhiều thành phần thời gian khác nhau. Các thành phần (time intervals) phổ biến được minh họa bao gồm:

*   **`DAY`:** Trích xuất ngày trong tháng.
*   **`MONTH`:** Trích xuất tháng.
*   **`YEAR`:** Trích xuất năm.
*   **`HOUR`:** Trích xuất giờ.
*   **`MINUTE`:** Trích xuất phút.

**Ví dụ minh họa cú pháp `EXTRACT()` trong MySQL:**

```sql
SELECT
    market_start_datetime,
    EXTRACT(DAY FROM market_start_datetime) AS mktsrt_day,
    EXTRACT(MONTH FROM market_start_datetime) AS mktsrt_month,
    EXTRACT(YEAR FROM market_start_datetime) AS mktsrt_year
    -- ... và các thành phần khác
FROM farmers_market.datetime_demo
```

### IV. Các Hàm Trích xuất Ngày/Giờ Liên quan

Ngoài `EXTRACT()`, MySQL còn cung cấp các hàm chuyên biệt khác để trích xuất các phần lớn hơn của giá trị `datetime` một cách nhanh chóng:

1.  **`DATE()`:** Trích xuất **phần ngày** từ một trường `datetime`.
2.  **`TIME()`:** Trích xuất **phần thời gian** từ một trường `datetime`.

Các hàm này cho phép trích xuất toàn bộ ngày hoặc giờ mà không cần trích xuất từng phần rồi nối lại.

### V. Ứng dụng Nâng cao của Trích xuất Ngày/Giờ

Trích xuất các thành phần ngày/giờ là bước cơ bản trong việc chuẩn bị dữ liệu cho các phân tích phức tạp hơn:

1.  **EDA (Exploratory Data Analysis):** Trích xuất năm và tháng từ ngày chợ (`market_date`) và sử dụng các trường này để nhóm và đếm số lượng nhà cung cấp hoặc sản phẩm theo từng tháng/năm, giúp khám phá sự thay đổi theo thời gian (Exploring Changes Over Time).
2.  **Kỹ thuật Tính năng (Feature Engineering):** Các thành phần ngày/giờ trích xuất được sử dụng làm tính năng đầu vào (input features) cho mô hình học máy. Ví dụ, trích xuất tháng từ `market_date` (`EXTRACT(MONTH FROM cp.market_date) AS market_month`) có thể giúp dự đoán liệu khách hàng có quay lại mua hàng hay không, vì các tháng thị trường đóng cửa (tháng 1 và tháng 2) có thể làm giảm khả năng khách hàng quay lại trong 30 ngày.
3.  **Tổng hợp theo Thời gian:** Các hàm trích xuất thường được sử dụng trong mệnh đề `GROUP BY` để tóm tắt dữ liệu theo các khoảng thời gian như năm, tháng, hoặc giờ. Ví dụ, nhóm theo năm và tháng để đếm số lượng nhà cung cấp duy nhất trong mỗi kỳ.
4.  **Kiểm soát Chất lượng (Quality Control):** Có thể sử dụng hàm `DAYNAME()` (hàm trả về tên ngày trong tuần) và `EXTRACT()` để kiểm tra xem dữ liệu ngày trong tuần được nhập thủ công có chính xác không, bằng cách so sánh ngày trong tuần được tính toán với ngày trong tuần đã lưu trữ.